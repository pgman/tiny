$.Tiny=function(){var t=function(n){var r,o=this;if(!(this instanceof t))return new t(n);this.variable=n.variable,this.controller=[],this.model=$.extend({},n.model);for(r in this.model)this.model[r].autoRender=!0;this.view=$.extend({},n.view),n.controller.forEach(function(t){o.on(t)}),e(this.variable,this.model,this.view,{name:"init"})()},e=function(t,e,n,r){return function(o){var i,a,l=this,f=e[r.name],u=n[r.name];a=r.delegator||r.target?[t,o,l]:[],f?(i=f.apply(e,a))&&i.then?i.then(function(){u&&f.autoRender&&u.apply(n,a)},function(){u&&f.autoRender&&u.apply(n,a)}):u&&f.autoRender&&u.apply(n,a):!u||f&&!f.autoRender||u.apply(n,a)}},n=function(t,e){var n=null;return t.forEach(function(t,r){t.id===e&&(n=t)}),n},r=function(){var t="___";for(i=0;i<8;i++)t+="abcdefghijklmnopqrstuvwxyz"[Math.floor(26*Math.random())];return t};return t.prototype.on=function(t){var o,i=$.extend({},t);if(i.id){if(null!==n(this.controller,i.id))throw new Error("onメソッド指定されたidが重複します。")}else for(;;)if(o=r(),null===n(this.controller,o)){i.id=o;break}if(!i.delegator&&!i.target)throw new Error("コントローラのパラメータが不正です");i.func=e(this.variable,this.model,this.view,i),this.controller.push(i),i.delegator?$(i.delegator).on(i.event,i.target,i.func):i.target&&$(i.target).on(i.event,i.func)},t.prototype.off=function(t){var e=n(this.controller,t);if(null===e)throw new Error("offメソッド指定されたidが見つかりません");if(e.delegator)$(e.delegator).off(e.event,e.target,e.func);else{if(!e.target)throw new Error("エラーが発生しました");$(e.target).off(e.event,e.func)}!function(t,e){var n=-1;t.forEach(function(t,r){t.id===e&&(n=r)}),n<0||t.splice(n,1)}(this.controller,t)},t}();